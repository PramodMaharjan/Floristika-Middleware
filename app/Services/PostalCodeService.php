<?php

namespace App\Services;

class PostalCodeService
{
    private array $zonePostcodes = [
        'Ampang' => [55300, 56100, 68000],
        'Bandar Saujana Putra' => [42610],
        'Bangi' => [43600,43650],
        'Banting' => [42700],
        'Batang Kali' => [44300],
        'Batu Caves' => [68100],
        'Beranang' => [43700],
        'Bestari Jaya' => [45600,45607,45609,45620],
        'Bukit Rotan' => [45700],
        'Cheras' => [43200,43207],
        'Cyberjaya' => [63000,63100,63200,63300],
        'Dengkil' => [43800,43807],
        'Hulu Langat' => [43100],
        'Jenjarom' => [42600],
        'Jeram' => [45800],
        'Kajang' => [43000,43007,43009,43558],
        'Kerling' => [44100],
        'Klang' => [
            41000,41050,41100,41150,41200,41250,41300,41400,41506,41560,
            41586,41672,41700,41710,41720,41900,41902,41904,41906,41908,
            41910,41912,41914,41916,41918,41990,42100,42200
        ],
        'Kuala Kubu Baru' => [44000,44010,44020,44110],
        'Kuala Lumpur' => [
            50000,50050,50088,50100,50150,50200,50250,50300,50350,50400,
            50450,50460,50470,50480,50490,50500,50502,50504,50505,50506,
            50507,50508,50512,50514,50515,50519,50528,50529,50530,50532,
            50534,50536,50540,50544,50546,50548,50550,50551,50552,50554,
            50556,50560,50562,50564,50566,50568,50572,50576,50578,50580,
            50582,50586,50588,50590,50592,50594,50596,50598,50599,50600,
            50603,50604,50605,50608,50609,50610,50612,50614,50620,50621,
            50622,50623,50626,50632,50634,50636,50638,50640,50642,50644,
            50646,50648,50650,50652,50653,50656,50658,50660,50661,50662,
            50664,50666,50668,50670,50672,50673,50676,50677,50678,50680,
            50682,50684,50688,50694,50700,50702,50704,50706,50708,50710,
            50712,50714,50716,50718,50720,50722,50724,50726,50728,50730,
            50732,50734,50736,50738,50740,50742,50744,50746,50748,50750,
            50752,50754,50758,50760,50762,50764,50766,50768,50770,50772,
            50774,50776,50778,50780,50782,50784,50786,50788,50790,50792,
            50794,50796,50798,50800,50802,50804,50806,50808,50810,50812,
            50814,50816,50818,50901,50902,50903,50904,50906,50907,50908,
            50909,50910,50911,50912,50913,50914,50915,50916,50917,50918,
            50919,50920,50921,50922,50923,50924,50925,50926,50927,50928,
            50929,50930,50931,50932,50933,50934,50935,50936,50937,50938,
            50939,50940,50941,50942,50943,50944,50945,50946,50947,50948,
            50949,50950,50988,50989,50990,51000,51100,51200,51700,51990,
            52000,52100,52200,53000,53100,53200,53300,53700,53800,53990,
            54000,54100,54200,55000,55100,55200,55700,55710,55720,55900,
            55902,55904,55906,55908,55910,55912,55914,55916,55918,55920,
            55922,55924,55926,55928,55930,55932,55934,55990,56000,57000,
            57100,57700,57990,58000,58100,58200,58700,58990,59000,59100,
            59200,59700,59800,59990,60000
        ],
        'Kuala Selangor' => [45000],
        'Petaling Jaya' => [
            46000,46050,46100,46150,46200,46300,46350,46400,46506,46547,
            46549,46551,46564,46582,46598,46662,46667,46668,46672,46675,
            46700,46710,46720,46730,46740,46750,46760,46770,46780,46781,
            46782,46783,46784,46785,46786,46787,46788,46789,46790,46791,
            46792,46793,46794,46795,46796,46797,46798,46799,46800,46801,
            46802,46803,46804,46805,46806,46860,46870,46960,46962,46964,
            46966,46968,46970,46972,46974,46976,46978,47300,47301,47307,
            47308,47400,47410,47800,47810,47820,47830
        ],
        'Port Klang' => [42000,42009],
        'Puchong' => [47100,47110,47120,47130,47140,47150,47160,47170,47180,47190],
        'Pulau Carey' => [42960],
        'Pulau Indah' => [42920],
        'Pulau Ketam' => [42940],
        'Putrajaya' => [
            62000,62007,62050,62100,62150,62200,62250,62300,62502,62504,62505,
            62506,62510,62512,62514,62516,62517,62518,62519,62520,62522,
            62524,62526,62527,62530,62532,62536,62540,62542,62546,62550,
            62551,62570,62574,62576,62582,62584,62590,62592,62596,62602,
            62604,62605,62606,62616,62618,62620,62623,62624,62628,62630,
            62632,62648,62652,62654,62662,62668,62670,62674,62675,62676,
            62677,62686,62692,62988
        ],
        'Rasa' => [44200],
        'Rawang' => [48000,48010,48020,48050,48100,48200,48300],
        'Sabak Bernam' => [45200,45207,45209],
        'Sekinchan' => [45400],
        'Semenyih' => [43500],
        'Sepang' => [43900, 64000],
        'Serdang' => [43400],
        'Seri Kembangan' => [43300],
        'Shah Alam' => [
            40000,40100,40150,40200,40300,40450,40520,40529,40542,40548,
            40550,40564,40570,40572,40576,40578,40592,40596,40604,40607,
            40608,40610,40622,40626,40646,40648,40702,40704,40712,40724,
            40804,40806,40808,40810,40990,40160,40500,40502,40503,40505,
            40512,40517,40551,40560,40582,40590,40594,40598,40612,40620,
            40632,40660,40664,40670,40672,40676,40680,40690,40700,40708,
            40710,40714,40716,40718,40720,40722,40726,40728,40730,40800,
            40802,40170,40400,40460,40470,40673,40674,40675,40706,40732,
            42300
        ],
        'Subang Jaya' => [47200,47500,47507,47600,47610,47620,47630,47640,47650],
        'Sungai Ayer Tawar' => [45100],
        'Sungai Besar' => [45300],
        'Sungai Buloh' => [47000],
        'Sungai Pelek' => [43950],
        'Tanjong Karang' => [45500],
        'Tanjong Sepat' => [42800],
        'Teluk Panglima Garang' => [42425,42500,42507,42509],
    ];

    private array $subzonePostcodes = [
        'Ampang South' => [55300, 56100],
        'Ampang North' => [68000],
        'Bandar Baru Bangi South East' => [43600],
        'Bandar Baru Bangi North West' => [43650],
        'Bandar Puncak Alam' => [42300],
        'Bandar Saujana Putra' => [42610],
        'Banting' => [42700],
        'Batang Kali' => [44300],
        'Batu Caves' => [68100],
        'Beranang' => [43700],
        'Bestari Jaya' => [45600, 45607, 45609, 45620],
        'Bukit Rotan' => [45700],
        'Cheras' => [43200, 43207],
        'Cyberjaya' => [63000, 63100, 63200, 63300],
        'Dengkil' => [43800, 43807],
        'Hulu Langat' => [43100],
        'Jenjarom' => [42600],
        'Jeram' => [45800],
        'Kajang' => [43000, 43007, 43009, 43558],
        'Kerling' => [44100],
        'Klang Centre' => [41000, 41100, 41150, 41200, 41250, 41300, 41400, 41506, 41560, 41586, 41672, 41700, 41902, 42100],
        'Klang Kapar' => [42200],
        'Klang Meru' => [41050, 41710, 41720, 41900, 41904, 41906, 41908, 41910, 41912, 41914, 41916, 41918, 41990],
        'KLIA' => [64000],
        'Kuala Kubu Baru' => [44000, 44010, 44020, 44110],
        'Kuala Lumpur Centre' => [
            50000, 50050, 50088, 50100, 50150, 50200, 50250, 50300, 50350, 50400,
            50450, 50504, 50505, 50506, 50507, 50530, 50534, 50546, 50548, 50550,
            50560, 50562, 50566, 50576, 50580, 50582, 50586, 50588, 50590, 50594,
            50596, 50598, 50599, 50604, 50609, 50610, 50612, 50621, 50622, 50623,
            50626, 50632, 50634, 50636, 50638, 50644, 50646, 50648, 50652, 50653,
            50656, 50658, 50660, 50661, 50666, 50668, 50670, 50676, 50708
        ],
        'Kuala Lumpur East' => [50508, 50532, 50540, 50554, 50564, 50764, 50929, 55000, 55100, 55200],
        'Kuala Lumpur North' => [50568, 50600, 50642, 51000, 51100, 51200, 51700, 51990],
        'Kuala Lumpur North East' => [53000, 53100, 53200, 53300, 54000, 54100, 54200, 50556, 50572, 50578, 50620, 50640, 50720, 50732, 53990],
        'Kuala Lumpur North West' => [52000, 52100, 52200],
        'Kuala Lumpur South' => [57000, 57100, 58200, 50536, 50592, 57700, 59990],
        'Kuala Lumpur South East' => [
            50664, 50988, 55700, 55710, 55720, 55900, 55902, 55904, 55906, 55908,
            55910, 55912, 55914, 55916, 55918, 55920, 55922, 55924, 55926, 55928,
            55930, 55932, 55934, 55990, 56000
        ],
        'Kuala Lumpur South West' => [
            50460, 50470, 50500, 50502, 50514, 50519, 50528, 50529, 50544, 50603,
            50614, 50672, 50673, 50678, 50682, 50684, 50688, 50700, 50702, 50704,
            50706, 50710, 50712, 50714, 50716, 50718, 50722, 50724, 50726, 50728,
            50730, 50734, 50736, 50738, 50740, 50742, 50744, 50746, 50748, 50750,
            50752, 50754, 50758, 50760, 50762, 50766, 50768, 50770, 50772, 50774,
            50776, 50778, 50780, 50782, 50784, 50786, 50788, 50790, 50792, 50794,
            50796, 50798, 50800, 50802, 50804, 50806, 50808, 50810, 50812, 50814,
            50816, 50818, 50901, 50902, 50903, 50904, 50906, 50907, 50908, 50909,
            50910, 50911, 50912, 50913, 50914, 50915, 50916, 50917, 50918, 50919,
            50920, 50921, 50922, 50923, 50924, 50925, 50926, 50927, 50928, 50930,
            50931, 50932, 50933, 50934, 50935, 50936, 50937, 50938, 50939, 50940,
            50941, 50942, 50943, 50944, 50945, 50946, 50947, 50948, 50949, 50950,
            50989, 50990, 53700, 53800, 57990, 58000, 58100, 58700, 58990, 59000,
            59100, 59200, 59700, 59800
        ],
        'Kuala Lumpur West' => [50480, 50490, 60000, 50512, 50515, 50551, 50552, 50605, 50608, 50650, 50662, 50677, 50680, 50694],
        'Kuala Selangor' => [45000],
        'Pelabuhan Klang' => [42000, 42009],
        'Petaling Jaya North' => [46547, 46549, 46551, 46667, 46675, 47308, 47400, 47410, 47800, 47810, 47820, 47830],
        'Petaling Jaya South' => [
            46000, 46050, 46100, 46150, 46200, 46300, 46350, 46400, 47300, 47301,
            46506, 46564, 46582, 46598, 46662, 46668, 46672, 46700, 46710, 46720,
            46730, 46740, 46750, 46760, 46770, 46780, 46781, 46782, 46783, 46784,
            46785, 46786, 46787, 46788, 46789, 46790, 46791, 46792, 46793, 46794,
            46795, 46796, 46797, 46798, 46799, 46800, 46801, 46802, 46803, 46804,
            46805, 46806, 46860, 46870, 46960, 46962, 46964, 46966, 46968, 46970,
            46972, 46974, 46976, 46978, 47307
        ],
        'Puchong North' => [47100, 47140, 47160, 47170, 47180, 47190],
        'Puchong South' => [47110, 47120, 47130, 47150],
        'Pulau Carey' => [42960],
        'Pulau Indah' => [42920],
        'Pulau Ketam' => [42940],
        'Putrajaya North' => [
            62000, 62007, 62050, 62250, 62300, 62502, 62504, 62505, 62506,
            62510, 62512, 62514, 62516, 62517, 62518, 62519, 62520, 62522,
            62524, 62526, 62527, 62530, 62532, 62536, 62540, 62542, 62546,
            62550, 62551, 62570, 62574, 62576, 62582, 62584, 62590, 62592,
            62596, 62602, 62604, 62605, 62606, 62616, 62618, 62620, 62623,
            62624, 62628, 62630, 62632, 62648, 62652, 62654, 62662, 62668,
            62670, 62674, 62675, 62676, 62677, 62686, 62692, 62988
        ],
        'Putrajaya South' => [62100, 62150, 62200],
        'Rasa' => [44200],
        'Rawang Batu Arang' => [48100],
        'Rawang Bukit Beruntung' => [48300],
        'Rawang Centre' => [48000],
        'Rawang Kundang' => [48020, 48050],
        'Rawang Saujana Rawang' => [48010],
        'Rawang Serendah' => [48200],
        'Sabak Bernam' => [45200, 45207, 45209],
        'Sekinchan' => [45400],
        'Semenyih' => [43500],
        'Sepang' => [43900, 64000],
        'Serdang' => [43400],
        'Seri Kembangan' => [43300],
        'Shah Alam Centre' => [
            40000,40100,40150,40200,40300,40450,40520,40529,40542,40548,
            40550,40564,40570,40572,40576,40578,40592,40596,40604,40607,
            40608,40610,40622,40626,40646,40648,40702,40704,40712,40724,
            40804,40806,40808,40810,40990
        ],
        'Shah Alam North' => [
            40160,40500,40502,40503,40505,40512,40517,40551,40560,40582,
            40590,40594,40598,40612,40620,40632,40660,40664,40670,40672,
            40676,40680,40690,40700,40708,40710,40714,40716,40718,40720,
            40722,40726,40728,40730,40800,40802
        ],
        'Shah Alam Setia Alam' => [40170],
        'Shah Alam South' => [40400, 40460, 40470, 40673, 40674, 40675, 40706, 40732],
        'Subang Jaya' => [47200, 47500, 47507, 47600, 47610, 47620, 47630, 47640, 47650],
        'Sungai Ayer Tawar' => [45100],
        'Sungai Besar' => [45300],
        'Sungai Buloh' => [47000],
        'Sungai Pelek' => [43950],
        'Tanjong Karang' => [45500],
        'Tanjong Sepat' => [42800],
        'Teluk Panglima Garang' => [42425, 42500, 42507, 42509]
    ];


    public function getZone(int $postcode): ?string
    {
        foreach ($this->zonePostcodes as $zone => $postcodes) {
            if (in_array($postcode, $postcodes, true)) {
                return $zone;
            }
        }
        return null;
    }

    public function getSubzone(int $postcode): ?string
    {
        foreach ($this->subzonePostcodes as $subzone => $postcodes) {
            if (in_array($postcode, $postcodes, true)) {
                return $subzone;
            }
        }
        return null;
    }
}
